<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ìˆ˜í•™ ë‹¨ê³„ë³„ êµì¬ ë·°ì–´</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=Noto+Serif+KR:wght@400;600;700&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #f0ede8;
  --stage-a: #e8401c;
  --stage-a-light: #fde8e3;
  --stage-a-mid: #f4a48e;
  --stage-b: #1a7fd4;
  --stage-b-light: #e0eefc;
  --stage-b-mid: #7ab8eb;
  --stage-c: #1aad6e;
  --stage-c-light: #dcf5eb;
  --stage-c-mid: #76d4a8;
  --ink: #1a1814;
  --ink-mid: #4a4540;
  --ink-light: #9a9088;
  --paper: #fffef9;
  --paper-line: #e8e0d0;
  --ui-bg: #ffffff;
  --ui-border: #e0dbd2;
  --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
  --shadow-md: 0 6px 24px rgba(0,0,0,0.12);
  --shadow-lg: 0 12px 48px rgba(0,0,0,0.16);
  --b5-w: 176mm;
  --b5-h: 250mm;

  --stage-color: var(--stage-a);
  --stage-light: var(--stage-a-light);
  --stage-mid: var(--stage-a-mid);
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Noto Sans KR', sans-serif;
  background: var(--bg);
  min-height: 100vh;
  overflow-x: hidden;
}

/* â•â• STAGE QUICK MENU â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.stage-quickmenu {
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 200;
  background: var(--ui-bg);
  border-bottom: 1px solid var(--ui-border);
  box-shadow: var(--shadow-sm);
}

.qm-inner {
  display: flex;
  align-items: stretch;
  height: 60px;
  padding: 0 24px;
  gap: 0;
}

.qm-logo {
  display: flex;
  align-items: center;
  gap: 10px;
  padding-right: 28px;
  border-right: 1px solid var(--ui-border);
  margin-right: 8px;
}

.qm-logo-icon {
  width: 34px; height: 34px;
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-family: 'DM Mono', monospace;
  font-size: 15px; font-weight: 500;
  color: white;
  background: var(--stage-color);
  transition: background 0.4s;
  letter-spacing: -0.03em;
}

.qm-logo-text {
  font-size: 14px;
  font-weight: 700;
  color: var(--ink);
  letter-spacing: -0.02em;
  line-height: 1.2;
}
.qm-logo-sub {
  font-size: 10px;
  font-weight: 400;
  color: var(--ink-light);
  letter-spacing: 0.05em;
}

/* ë‹¨ê³„ íƒ­ */
.qm-stages {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 0 8px;
}

.stage-tab {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 18px;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
  border: 2px solid transparent;
  position: relative;
}

.stage-tab-badge {
  width: 28px; height: 28px;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-family: 'DM Mono', monospace;
  font-size: 13px; font-weight: 500;
  transition: all 0.2s;
}

.stage-tab-info { line-height: 1.2; }
.stage-tab-label {
  font-size: 13px; font-weight: 700;
  transition: color 0.2s;
}
.stage-tab-sub {
  font-size: 10px;
  color: var(--ink-light);
  font-weight: 400;
}

/* Aë‹¨ê³„ */
.stage-tab[data-stage="A"] .stage-tab-badge { background: var(--stage-a-light); color: var(--stage-a); }
.stage-tab[data-stage="A"]:hover { background: var(--stage-a-light); }
.stage-tab[data-stage="A"].active { background: var(--stage-a-light); border-color: var(--stage-a); }
.stage-tab[data-stage="A"].active .stage-tab-label { color: var(--stage-a); }
.stage-tab[data-stage="A"].active .stage-tab-badge { background: var(--stage-a); color: white; }

/* Bë‹¨ê³„ */
.stage-tab[data-stage="B"] .stage-tab-badge { background: var(--stage-b-light); color: var(--stage-b); }
.stage-tab[data-stage="B"]:hover { background: var(--stage-b-light); }
.stage-tab[data-stage="B"].active { background: var(--stage-b-light); border-color: var(--stage-b); }
.stage-tab[data-stage="B"].active .stage-tab-label { color: var(--stage-b); }
.stage-tab[data-stage="B"].active .stage-tab-badge { background: var(--stage-b); color: white; }

/* Cë‹¨ê³„ */
.stage-tab[data-stage="C"] .stage-tab-badge { background: var(--stage-c-light); color: var(--stage-c); }
.stage-tab[data-stage="C"]:hover { background: var(--stage-c-light); }
.stage-tab[data-stage="C"].active { background: var(--stage-c-light); border-color: var(--stage-c); }
.stage-tab[data-stage="C"].active .stage-tab-label { color: var(--stage-c); }
.stage-tab[data-stage="C"].active .stage-tab-badge { background: var(--stage-c); color: white; }

/* ì§„í–‰ë°” */
.qm-progress-wrap {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 0 16px;
  border-left: 1px solid var(--ui-border);
  margin-left: 8px;
}
.progress-bars { display: flex; flex-direction: column; gap: 5px; min-width: 120px; }
.progress-row { display: flex; align-items: center; gap: 6px; font-size: 10px; color: var(--ink-light); }
.progress-track {
  flex: 1; height: 4px; background: #e8e0d0; border-radius: 2px; overflow: hidden;
}
.progress-fill { height: 100%; border-radius: 2px; transition: width 0.5s ease; }
.progress-fill.a { background: var(--stage-a); width: 65%; }
.progress-fill.b { background: var(--stage-b); width: 30%; }
.progress-fill.c { background: var(--stage-c); width: 10%; }

/* ìš°ì¸¡ ì»¨íŠ¸ë¡¤ */
.qm-controls {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: 8px;
}

.ctrl-btn {
  display: flex; align-items: center; gap: 5px;
  padding: 6px 12px;
  border-radius: 6px;
  border: 1px solid var(--ui-border);
  background: none;
  font-family: 'Noto Sans KR', sans-serif;
  font-size: 11px;
  color: var(--ink-mid);
  cursor: pointer;
  transition: all 0.15s;
  white-space: nowrap;
}
.ctrl-btn:hover { background: var(--bg); }
.ctrl-btn svg { width: 13px; height: 13px; flex-shrink: 0; }

/* â•â• í˜ì´ì§€ ì´ë™ ë“œë¡­ë‹¤ìš´ â•â• */
.page-jump-wrap {
  position: relative;
}
.page-jump-btn {
  display: flex; align-items: center; gap: 6px;
  padding: 6px 14px;
  border-radius: 6px;
  border: 2px solid var(--stage-color);
  background: none;
  font-family: 'DM Mono', monospace;
  font-size: 12px;
  color: var(--stage-color);
  cursor: pointer;
  transition: all 0.2s;
  min-width: 90px;
  justify-content: center;
}
.page-jump-btn:hover { background: var(--stage-light); }

.page-dropdown {
  position: absolute;
  top: calc(100% + 8px);
  right: 0;
  background: var(--ui-bg);
  border: 1px solid var(--ui-border);
  border-radius: 12px;
  box-shadow: var(--shadow-lg);
  padding: 12px;
  display: none;
  grid-template-columns: repeat(5, 1fr);
  gap: 4px;
  width: 220px;
  z-index: 300;
}
.page-dropdown.open { display: grid; }

.pd-item {
  aspect-ratio: 1;
  border-radius: 6px;
  display: flex; align-items: center; justify-content: center;
  font-family: 'DM Mono', monospace;
  font-size: 11px;
  color: var(--ink-mid);
  cursor: pointer;
  transition: all 0.15s;
  border: 1.5px solid transparent;
}
.pd-item:hover { background: var(--stage-light); color: var(--stage-color); border-color: var(--stage-mid); }
.pd-item.current { background: var(--stage-color); color: white; }

/* â•â• TOOLBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.toolbar {
  position: fixed;
  top: 60px; left: 0; right: 0;
  z-index: 150;
  height: 44px;
  background: var(--ui-bg);
  border-bottom: 1px solid var(--ui-border);
  display: flex;
  align-items: center;
  padding: 0 24px;
  gap: 12px;
}

.tb-stage-badge {
  display: flex; align-items: center; gap: 6px;
  padding: 4px 12px;
  border-radius: 6px;
  background: var(--stage-light);
  font-size: 12px; font-weight: 700;
  color: var(--stage-color);
  transition: all 0.4s;
  letter-spacing: 0.02em;
}
.tb-stage-dot {
  width: 7px; height: 7px; border-radius: 50%;
  background: var(--stage-color);
  transition: background 0.4s;
}

.tb-sep { width: 1px; height: 20px; background: var(--ui-border); }

.tb-group { display: flex; align-items: center; gap: 2px; }

.tb-btn {
  padding: 4px 10px;
  border-radius: 5px;
  border: 1px solid transparent;
  background: none;
  font-family: 'Noto Sans KR', sans-serif;
  font-size: 11px;
  color: var(--ink-mid);
  cursor: pointer;
  transition: all 0.15s;
}
.tb-btn:hover { background: var(--bg); border-color: var(--ui-border); }
.tb-btn.active { background: var(--stage-light); border-color: var(--stage-mid); color: var(--stage-color); }

.zoom-val {
  font-family: 'DM Mono', monospace;
  font-size: 11px;
  color: var(--stage-color);
  min-width: 38px; text-align: center;
  transition: color 0.4s;
}

.tb-right { margin-left: auto; display: flex; align-items: center; gap: 12px; }
.tb-pageinfo {
  font-family: 'DM Mono', monospace;
  font-size: 11px;
  color: var(--ink-light);
}

/* â•â• LAYOUT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.app-layout {
  display: flex;
  padding-top: 104px; /* quickmenu 60 + toolbar 44 */
  min-height: 100vh;
}

/* â•â• SIDEBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.sidebar {
  width: 220px;
  flex-shrink: 0;
  background: var(--ui-bg);
  border-right: 1px solid var(--ui-border);
  position: fixed;
  top: 104px; bottom: 0; left: 0;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  transition: transform 0.3s ease;
}
.sidebar.hidden { transform: translateX(-100%); }

.sb-header {
  padding: 14px 16px 10px;
  border-bottom: 1px solid var(--ui-border);
  display: flex; align-items: center; gap: 8px;
}
.sb-header-dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: var(--stage-color);
  transition: background 0.4s;
}
.sb-header-text {
  font-size: 10px; font-weight: 700;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--ink-light);
}

.sb-scroll {
  flex: 1; overflow-y: auto; padding: 12px 10px;
  display: flex; flex-direction: column; gap: 6px;
  scrollbar-width: thin; scrollbar-color: var(--ui-border) transparent;
}

.thumb-item {
  display: flex; align-items: flex-start; gap: 8px;
  cursor: pointer; padding: 4px;
  border-radius: 6px; transition: all 0.15s;
}
.thumb-item:hover { background: var(--bg); }
.thumb-item.active { background: var(--stage-light); }

.thumb-num {
  font-family: 'DM Mono', monospace;
  font-size: 10px; color: var(--ink-light);
  min-width: 20px; text-align: right;
  padding-top: 3px; transition: color 0.15s;
}
.thumb-item.active .thumb-num { color: var(--stage-color); font-weight: 500; }

.thumb-page {
  flex: 1; aspect-ratio: 176/250;
  background: var(--paper);
  border-radius: 2px;
  border: 1.5px solid var(--ui-border);
  transition: all 0.15s; overflow: hidden;
  position: relative;
}
.thumb-item.active .thumb-page { border-color: var(--stage-color); }

.thumb-stage-bar {
  position: absolute; top: 0; left: 0; right: 0;
  height: 4px;
  background: var(--stage-color);
  transition: background 0.4s;
}
.thumb-content-lines {
  position: absolute; top: 14%; left: 10%; right: 10%;
  display: flex; flex-direction: column; gap: 5%;
}
.tl { height: 5%; background: #d8d0c0; border-radius: 1px; }
.tl.h { height: 7%; background: #b8b0a0; width: 75%; margin-bottom: 3%; }
.tl.s { width: 55%; }
.tl.m { width: 80%; }

/* â•â• VIEWER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.viewer-main {
  margin-left: 220px;
  flex: 1;
  transition: margin-left 0.3s ease;
}
.viewer-main.full { margin-left: 0; }

.viewer-scroll {
  padding: 40px 60px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 32px;
}

/* â•â• B5 PAGE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.b5-page {
  width: var(--b5-w);
  flex-shrink: 0;
  background: var(--paper);
  position: relative;
  border-radius: 2px;
  box-shadow:
    0 1px 3px rgba(0,0,0,0.08),
    0 6px 20px rgba(0,0,0,0.12),
    0 16px 48px rgba(0,0,0,0.1);
  overflow: hidden;
  transition: box-shadow 0.3s, transform 0.3s;
  animation: pageIn 0.4s ease both;
}
.b5-page:hover {
  box-shadow:
    0 2px 6px rgba(0,0,0,0.1),
    0 10px 28px rgba(0,0,0,0.16),
    0 24px 64px rgba(0,0,0,0.13);
  transform: translateY(-2px);
}

@keyframes pageIn {
  from { opacity: 0; transform: translateY(12px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* ë‹¨ê³„ìƒ‰ ìƒë‹¨ ë°” */
.page-stage-bar {
  height: 5px;
  background: var(--stage-color);
  transition: background 0.4s;
}

/* í˜ì´ì§€ ë‚´ìš© ì˜ì—­ */
.page-inner {
  padding: 12mm 15mm 14mm 18mm;
  min-height: calc(var(--b5-h) - 5px);
  display: flex;
  flex-direction: column;
  position: relative;
}

/* ì¤„ë…¸íŠ¸ ë°°ê²½ */
.page-inner.lined {
  background-image: repeating-linear-gradient(
    to bottom,
    transparent, transparent calc(8mm - 1px),
    #ece5d8 calc(8mm - 1px), #ece5d8 8mm
  );
}

/* í˜ì´ì§€ í—¤ë” */
.page-hd {
  display: flex; align-items: flex-start;
  justify-content: space-between;
  margin-bottom: 6mm;
  padding-bottom: 4mm;
  border-bottom: 2px solid var(--stage-color);
  transition: border-color 0.4s;
}
.page-hd-left {}
.page-hd-stage {
  font-family: 'DM Mono', monospace;
  font-size: 8.5pt; font-weight: 500;
  color: var(--stage-color);
  letter-spacing: 0.15em;
  text-transform: uppercase;
  transition: color 0.4s;
}
.page-hd-title {
  font-family: 'Noto Serif KR', serif;
  font-size: 16pt; font-weight: 700;
  color: var(--ink);
  margin-top: 2mm;
  line-height: 1.25;
}
.page-hd-right {
  text-align: right;
}
.page-hd-num {
  font-family: 'DM Mono', monospace;
  font-size: 9pt;
  color: var(--ink-light);
}
.page-hd-date {
  font-size: 8pt;
  color: var(--ink-light);
  margin-top: 1mm;
}

/* í•™ìŠµ ëª©í‘œ ë°•ìŠ¤ */
.page-goal {
  background: var(--stage-light);
  border-left: 3px solid var(--stage-color);
  border-radius: 0 6px 6px 0;
  padding: 3.5mm 5mm;
  margin-bottom: 6mm;
  transition: background 0.4s, border-color 0.4s;
}
.page-goal-label {
  font-size: 7.5pt; font-weight: 700;
  color: var(--stage-color);
  letter-spacing: 0.1em;
  text-transform: uppercase;
  margin-bottom: 1.5mm;
  transition: color 0.4s;
}
.page-goal-text {
  font-size: 9pt; color: var(--ink-mid);
  line-height: 1.6;
}

/* ë¬¸ì œ ì˜ì—­ */
.page-section-title {
  font-size: 8pt; font-weight: 700;
  color: var(--ink-mid);
  letter-spacing: 0.1em;
  text-transform: uppercase;
  margin-bottom: 4mm;
  display: flex; align-items: center; gap: 6px;
}
.page-section-title::after {
  content: '';
  flex: 1; height: 1px; background: var(--paper-line);
}

.problems-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 3mm 6mm;
  flex: 1;
}

.problem-item {
  display: flex; align-items: baseline; gap: 3mm;
  padding: 2.5mm 0;
  border-bottom: 1px solid var(--paper-line);
}
.problem-num {
  font-family: 'DM Mono', monospace;
  font-size: 8pt; font-weight: 500;
  color: var(--stage-color);
  min-width: 16px;
  transition: color 0.4s;
}
.problem-expr {
  font-family: 'Noto Serif KR', serif;
  font-size: 11pt;
  color: var(--ink);
  flex: 1;
}
.problem-answer {
  width: 20mm; height: 6mm;
  border-bottom: 1.5px solid var(--ink-light);
  flex-shrink: 0;
}

/* ë¹ˆ í˜ì´ì§€ */
.blank-center {
  flex: 1; display: flex; align-items: center; justify-content: center;
  flex-direction: column; gap: 8px;
}
.blank-icon { font-size: 28px; opacity: 0.25; }
.blank-text {
  font-size: 9pt; color: var(--ink-light);
  font-style: italic;
}

/* í˜ì´ì§€ í‘¸í„° */
.page-ft {
  margin-top: auto; padding-top: 4mm;
  display: flex; align-items: center;
  justify-content: space-between;
  border-top: 1px solid var(--paper-line);
}
.page-ft-score {
  display: flex; align-items: center; gap: 2mm;
  font-size: 8pt; color: var(--ink-light);
}
.score-box {
  width: 14mm; height: 6mm;
  border: 1px solid var(--paper-line);
  border-radius: 3px;
}
.page-ft-num {
  font-family: 'DM Mono', monospace;
  font-size: 8pt; color: var(--ink-light);
}

/* ë‹¨ê³„ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ */
.stage-transition {
  position: fixed; inset: 0; z-index: 1000;
  display: flex; align-items: center; justify-content: center;
  pointer-events: none; opacity: 0;
  transition: opacity 0.3s;
}
.stage-transition.show { opacity: 1; pointer-events: all; }
.stage-transition-inner {
  font-family: 'Noto Sans KR', sans-serif;
  font-size: 48px; font-weight: 900;
  color: white;
  background: var(--stage-color);
  padding: 20px 48px;
  border-radius: 16px;
  letter-spacing: 0.1em;
  box-shadow: var(--shadow-lg);
  transition: background 0.4s;
}

/* â•â• STATUS BAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.statusbar {
  position: fixed;
  bottom: 0; left: 0; right: 0;
  height: 26px;
  background: var(--ui-bg);
  border-top: 1px solid var(--ui-border);
  display: flex; align-items: center;
  padding: 0 20px; gap: 20px;
  font-size: 10px; color: var(--ink-light);
  font-family: 'DM Mono', monospace;
  z-index: 100;
}
.sb-item { display: flex; gap: 5px; }
.sb-k { color: var(--ink-light); }
.sb-v { color: var(--stage-color); transition: color 0.4s; }

/* ìŠ¤í¬ë¡¤ë°” */
body::-webkit-scrollbar { width: 6px; }
body::-webkit-scrollbar-thumb { background: var(--ui-border); border-radius: 3px; }

/* í•˜ë‹¨ ì—¬ë°± (statusbar) */
.viewer-scroll { padding-bottom: 60px; }

/* ë°˜ì‘í˜• */
@media (max-width: 1000px) {
  .sidebar { display: none; }
  .viewer-main { margin-left: 0; }
  :root { --b5-w: 90vw; }
  .qm-progress-wrap { display: none; }
}

@media (max-width: 700px) {
  .stage-tab-info { display: none; }
  .qm-logo-text { display: none; }
  .viewer-scroll { padding: 20px 16px; }
}
</style>
</head>
<body>

<!-- ë‹¨ê³„ ì „í™˜ ì˜¤ë²„ë ˆì´ -->
<div class="stage-transition" id="stage-overlay">
  <div class="stage-transition-inner" id="stage-overlay-text">Aë‹¨ê³„</div>
</div>

<!-- â•â• QUICK MENU â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<nav class="stage-quickmenu">
  <div class="qm-inner">

    <div class="qm-logo">
      <div class="qm-logo-icon" id="logo-icon">ìˆ˜í•™</div>
      <div>
        <div class="qm-logo-text">ìˆ˜í•™ êµì¬</div>
        <div class="qm-logo-sub">ë‹¨ê³„ë³„ í•™ìŠµ ë·°ì–´</div>
      </div>
    </div>

    <div class="qm-stages">
      <div class="stage-tab active" data-stage="A" onclick="switchStage('A')">
        <div class="stage-tab-badge">A</div>
        <div class="stage-tab-info">
          <div class="stage-tab-label">Aë‹¨ê³„</div>
          <div class="stage-tab-sub">ê¸°ì´ˆ ì—°ì‚°</div>
        </div>
      </div>
      <div class="stage-tab" data-stage="B" onclick="switchStage('B')">
        <div class="stage-tab-badge">B</div>
        <div class="stage-tab-info">
          <div class="stage-tab-label">Bë‹¨ê³„</div>
          <div class="stage-tab-sub">ì‚¬ì¹™ì—°ì‚°</div>
        </div>
      </div>
      <div class="stage-tab" data-stage="C" onclick="switchStage('C')">
        <div class="stage-tab-badge">C</div>
        <div class="stage-tab-info">
          <div class="stage-tab-label">Cë‹¨ê³„</div>
          <div class="stage-tab-sub">ë¶„ìˆ˜Â·ì†Œìˆ˜</div>
        </div>
      </div>
    </div>

    <div class="qm-progress-wrap">
      <div class="progress-bars">
        <div class="progress-row">
          <span style="color:var(--stage-a);font-weight:700;min-width:16px">A</span>
          <div class="progress-track"><div class="progress-fill a"></div></div>
          <span>65%</span>
        </div>
        <div class="progress-row">
          <span style="color:var(--stage-b);font-weight:700;min-width:16px">B</span>
          <div class="progress-track"><div class="progress-fill b"></div></div>
          <span>30%</span>
        </div>
        <div class="progress-row">
          <span style="color:var(--stage-c);font-weight:700;min-width:16px">C</span>
          <div class="progress-track"><div class="progress-fill c"></div></div>
          <span>10%</span>
        </div>
      </div>
    </div>

    <div class="qm-controls">
      <button class="ctrl-btn" onclick="toggleSidebar()">
        <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
          <rect x="1" y="1" width="14" height="14" rx="2"/><line x1="5" y1="1" x2="5" y2="15"/>
        </svg>
        ëª©ë¡
      </button>
      <button class="ctrl-btn" onclick="toggleLineStyle()">
        <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
          <line x1="2" y1="5" x2="14" y2="5"/><line x1="2" y1="9" x2="14" y2="9"/><line x1="2" y1="13" x2="14" y2="13"/>
        </svg>
        <span id="line-btn-text">ì¤„ í‘œì‹œ</span>
      </button>

      <div class="page-jump-wrap">
        <button class="page-jump-btn" id="pj-btn" onclick="togglePageDropdown()">
          <svg width="12" height="12" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.8">
            <rect x="2" y="2" width="5" height="5" rx="1"/><rect x="9" y="2" width="5" height="5" rx="1"/>
            <rect x="2" y="9" width="5" height="5" rx="1"/><rect x="9" y="9" width="5" height="5" rx="1"/>
          </svg>
          <span id="pj-label">1 / 10</span>
        </button>
        <div class="page-dropdown" id="page-dropdown"></div>
      </div>
    </div>

  </div>
</nav>

<!-- â•â• TOOLBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="toolbar">
  <div class="tb-stage-badge" id="tb-badge">
    <div class="tb-stage-dot" id="tb-dot"></div>
    <span id="tb-stage-label">Aë‹¨ê³„ Â· ê¸°ì´ˆ ì—°ì‚°</span>
  </div>
  <div class="tb-sep"></div>
  <div class="tb-group">
    <button class="tb-btn" onclick="changeZoom(-10)">âˆ’</button>
    <span class="zoom-val" id="zoom-val">100%</span>
    <button class="tb-btn" onclick="changeZoom(10)">+</button>
    <button class="tb-btn" onclick="resetZoom()">ë§ì¶¤</button>
  </div>
  <div class="tb-sep"></div>
  <div class="tb-group">
    <button class="tb-btn active" id="btn-single" onclick="setLayout('single')">ë‹¨ë©´</button>
    <button class="tb-btn" id="btn-double" onclick="setLayout('double')">ì–‘ë©´</button>
  </div>
  <div class="tb-right">
    <span class="tb-pageinfo" id="tb-pageinfo">1 / 10 Â· B5 176Ã—250mm</span>
  </div>
</div>

<!-- â•â• BODY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="app-layout">

  <aside class="sidebar" id="sidebar">
    <div class="sb-header">
      <div class="sb-header-dot" id="sb-dot"></div>
      <span class="sb-header-text" id="sb-header-text">Aë‹¨ê³„ í˜ì´ì§€</span>
    </div>
    <div class="sb-scroll" id="thumb-list"></div>
  </aside>

  <main class="viewer-main" id="viewer-main">
    <div class="viewer-scroll" id="viewer-scroll"></div>
  </main>

</div>

<!-- â•â• STATUS BAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="statusbar">
  <div class="sb-item"><span class="sb-k">ë‹¨ê³„</span><span class="sb-v" id="st-stage">Aë‹¨ê³„</span></div>
  <div class="sb-item"><span class="sb-k">í˜ì´ì§€</span><span class="sb-v" id="st-page">1/10</span></div>
  <div class="sb-item"><span class="sb-k">í™•ëŒ€</span><span class="sb-v" id="st-zoom">100%</span></div>
  <div class="sb-item"><span class="sb-k">ë ˆì´ì•„ì›ƒ</span><span class="sb-v" id="st-layout">ë‹¨ë©´</span></div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ë°ì´í„° ì •ì˜
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const STAGES = {
  A: {
    label: 'Aë‹¨ê³„',
    sub: 'ê¸°ì´ˆ ì—°ì‚°',
    color: '#e8401c',
    light: '#fde8e3',
    mid: '#f4a48e',
    pages: [
      { title: 'ë§ì…ˆì˜ ê¸°ì´ˆ', goal: 'í•œ ìë¦¬ ìˆ˜ì˜ ë§ì…ˆì„ ì´í•´í•˜ê³ , ì •í™•í•˜ê²Œ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.',
        problems: ['1+1', '2+3', '4+2', '3+5', '6+1', '2+7', '5+3', '4+4', '7+2', '3+6', '8+1', '5+4'] },
      { title: 'ë§ì…ˆ ì—°ìŠµ â‘ ', goal: 'ë°›ì•„ì˜¬ë¦¼ì´ ì—†ëŠ” ë‘ ìë¦¬ ìˆ˜ ë§ì…ˆì„ ê³„ì‚°í•œë‹¤.',
        problems: ['11+12', '23+14', '30+25', '42+17', '15+34', '21+28', '13+46', '30+20', '41+18', '22+37', '10+55', '33+16'] },
      { title: 'ë§ì…ˆ ì—°ìŠµ â‘¡', goal: 'ë°›ì•„ì˜¬ë¦¼ì´ ìˆëŠ” ë§ì…ˆì„ ì´í•´í•˜ê³  ê³„ì‚°í•œë‹¤.',
        problems: ['9+5', '7+6', '8+8', '6+7', '9+9', '5+8', '7+7', '4+9', '8+6', '9+4', '6+6', '7+9'] },
      { title: 'ëº„ì…ˆì˜ ê¸°ì´ˆ', goal: 'í•œ ìë¦¬ ìˆ˜ì˜ ëº„ì…ˆì„ ì´í•´í•˜ê³  ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.',
        problems: ['9-4', '8-3', '7-2', '6-1', '5-3', '8-5', '7-4', '9-6', '6-2', '8-7', '9-3', '7-5'] },
      { title: 'ëº„ì…ˆ ì—°ìŠµ', goal: 'ë°›ì•„ë‚´ë¦¼ì´ ì—†ëŠ” ë‘ ìë¦¬ ìˆ˜ ëº„ì…ˆì„ ê³„ì‚°í•œë‹¤.',
        problems: ['29-15', '38-12', '47-23', '56-34', '65-41', '74-52', '83-31', '92-60', '48-16', '57-24', '66-32', '75-43'] },
      { title: 'ë§ì…ˆê³¼ ëº„ì…ˆ', goal: 'ë§ì…ˆê³¼ ëº„ì…ˆì„ í˜¼í•©í•˜ì—¬ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.',
        problems: ['5+3-2', '8-4+1', '7+2-3', '6-1+4', '9+0-5', '3+6-4', '8-3+2', '7+1-5', '4+5-6', '9-2+1', '6+3-7', '5-2+8'] },
      { title: '10 ë§Œë“¤ê¸°', goal: 'í•©ì´ 10ì´ ë˜ëŠ” ìˆ˜ì˜ ìŒì„ ì•Œê³  ê³„ì‚°ì— í™œìš©í•œë‹¤.',
        problems: ['1+9', '2+8', '3+7', '4+6', '5+5', '10-1', '10-2', '10-3', '10-7', '10-8', '6+4', '10-6'] },
      { title: 'ìˆ˜ ì„¸ê¸°ì™€ ìˆœì„œ', goal: '100ê¹Œì§€ì˜ ìˆ˜ë¥¼ ì„¸ê³  ìˆœì„œë¥¼ ì•Œ ìˆ˜ ìˆë‹¤.',
        problems: ['10+10', '20+10', '30+10', '40+10', '50+10', '60+10', '70+10', '80+10', '90+10', '100-10', '50+20', '70+20'] },
      { title: 'ì¢…í•© ì—°ìŠµ â‘ ', goal: 'ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ë§ì…ˆÂ·ëº„ì…ˆ ì „ì²´ ë³µìŠµ',
        problems: ['15+8', '23-9', '36+7', '44-8', '52+9', '61-7', '78+6', '85-9', '17+16', '24-15', '33+28', '47-19'] },
      { title: 'ì¢…í•© í‰ê°€', goal: 'Aë‹¨ê³„ ì „ì²´ ë‚´ìš©ì„ ì ê²€í•˜ê³  ì‹¤ë ¥ì„ í™•ì¸í•œë‹¤.',
        problems: ['7+8', '13-6', '25+9', '34-8', '47+6', '56-9', '19+12', '28-13', '35+27', '46-18', '53+29', '64-27'],
        isTest: true },
    ]
  },
  B: {
    label: 'Bë‹¨ê³„',
    sub: 'ì‚¬ì¹™ì—°ì‚°',
    color: '#1a7fd4',
    light: '#e0eefc',
    mid: '#7ab8eb',
    pages: [
      { title: 'ê³±ì…ˆì˜ ê¸°ì´ˆ', goal: 'ê°™ì€ ìˆ˜ë¥¼ ì—¬ëŸ¬ ë²ˆ ë”í•˜ëŠ” ê²ƒì´ ê³±ì…ˆì„ì„ ì´í•´í•œë‹¤.',
        problems: ['2Ã—1', '2Ã—2', '2Ã—3', '2Ã—4', '2Ã—5', '2Ã—6', '2Ã—7', '2Ã—8', '2Ã—9', '3Ã—1', '3Ã—2', '3Ã—3'] },
      { title: 'êµ¬êµ¬ë‹¨ 2~3ë‹¨', goal: 'êµ¬êµ¬ë‹¨ 2ë‹¨ê³¼ 3ë‹¨ì„ ì •í™•íˆ ì™¸ìš°ê³  ê³„ì‚°í•œë‹¤.',
        problems: ['2Ã—7', '3Ã—4', '2Ã—9', '3Ã—6', '2Ã—5', '3Ã—8', '2Ã—3', '3Ã—7', '2Ã—8', '3Ã—5', '2Ã—6', '3Ã—9'] },
      { title: 'êµ¬êµ¬ë‹¨ 4~5ë‹¨', goal: 'êµ¬êµ¬ë‹¨ 4ë‹¨ê³¼ 5ë‹¨ì„ ì •í™•íˆ ì™¸ìš°ê³  ê³„ì‚°í•œë‹¤.',
        problems: ['4Ã—3', '5Ã—6', '4Ã—7', '5Ã—4', '4Ã—9', '5Ã—8', '4Ã—5', '5Ã—7', '4Ã—6', '5Ã—9', '4Ã—8', '5Ã—3'] },
      { title: 'êµ¬êµ¬ë‹¨ 6~7ë‹¨', goal: 'êµ¬êµ¬ë‹¨ 6ë‹¨ê³¼ 7ë‹¨ì„ ì •í™•íˆ ì™¸ìš°ê³  ê³„ì‚°í•œë‹¤.',
        problems: ['6Ã—4', '7Ã—3', '6Ã—8', '7Ã—6', '6Ã—5', '7Ã—9', '6Ã—7', '7Ã—4', '6Ã—9', '7Ã—7', '6Ã—6', '7Ã—8'] },
      { title: 'êµ¬êµ¬ë‹¨ 8~9ë‹¨', goal: 'êµ¬êµ¬ë‹¨ 8ë‹¨ê³¼ 9ë‹¨ì„ ì •í™•íˆ ì™¸ìš°ê³  ê³„ì‚°í•œë‹¤.',
        problems: ['8Ã—3', '9Ã—4', '8Ã—7', '9Ã—6', '8Ã—5', '9Ã—8', '8Ã—9', '9Ã—7', '8Ã—6', '9Ã—9', '8Ã—4', '9Ã—5'] },
      { title: 'ë‚˜ëˆ—ì…ˆì˜ ê¸°ì´ˆ', goal: 'ë‚˜ëˆ—ì…ˆì˜ ì˜ë¯¸ë¥¼ ì´í•´í•˜ê³  ê¸°ë³¸ ë‚˜ëˆ—ì…ˆì„ ê³„ì‚°í•œë‹¤.',
        problems: ['6Ã·2', '9Ã·3', '8Ã·4', '10Ã·5', '12Ã·6', '14Ã·7', '16Ã·8', '18Ã·9', '15Ã·3', '20Ã·4', '24Ã·6', '27Ã·9'] },
      { title: 'ê³±ì…ˆê³¼ ë‚˜ëˆ—ì…ˆ', goal: 'ê³±ì…ˆê³¼ ë‚˜ëˆ—ì…ˆì˜ ê´€ê³„ë¥¼ ì´í•´í•˜ê³  í™œìš©í•œë‹¤.',
        problems: ['3Ã—7', '21Ã·3', '4Ã—6', '24Ã·4', '5Ã—8', '40Ã·5', '6Ã—7', '42Ã·6', '7Ã—8', '56Ã·7', '8Ã—9', '72Ã·8'] },
      { title: 'ë‘ ìë¦¬ ê³±ì…ˆ', goal: 'ë‘ ìë¦¬ ìˆ˜ì™€ í•œ ìë¦¬ ìˆ˜ì˜ ê³±ì…ˆì„ ê³„ì‚°í•œë‹¤.',
        problems: ['12Ã—3', '21Ã—4', '13Ã—5', '31Ã—2', '14Ã—3', '23Ã—4', '32Ã—3', '11Ã—8', '22Ã—4', '24Ã—2', '33Ã—3', '41Ã—2'] },
      { title: 'ì¢…í•© ì—°ìŠµ', goal: 'ì‚¬ì¹™ì—°ì‚° ì¢…í•© ë³µìŠµ ë° í˜¼í•© ê³„ì‚°',
        problems: ['6Ã—7', '48Ã·8', '9Ã—8', '63Ã·7', '15Ã—4', '72Ã·9', '24Ã—3', '56Ã·8', '7Ã—6-3', '48Ã·6+5', '9Ã—4-12', '36Ã·4+7'] },
      { title: 'Bë‹¨ê³„ í‰ê°€', goal: 'Bë‹¨ê³„ ì‚¬ì¹™ì—°ì‚° ì „ì²´ ì‹¤ë ¥ ì ê²€',
        problems: ['8Ã—7', '63Ã·9', '12Ã—6', '84Ã·7', '9Ã—9', '72Ã·8', '15Ã—5', '96Ã·6', '7Ã—8', '48Ã·6', '13Ã—7', '91Ã·7'],
        isTest: true },
    ]
  },
  C: {
    label: 'Cë‹¨ê³„',
    sub: 'ë¶„ìˆ˜Â·ì†Œìˆ˜',
    color: '#1aad6e',
    light: '#dcf5eb',
    mid: '#76d4a8',
    pages: [
      { title: 'ë¶„ìˆ˜ì˜ ê¸°ì´ˆ', goal: 'ë¶„ìˆ˜ì˜ ì˜ë¯¸ë¥¼ ì´í•´í•˜ê³ , ë¶„ìˆ˜ë¥¼ ì½ê³  ì“¸ ìˆ˜ ìˆë‹¤.',
        problems: ['1/2+1/2', '1/3+1/3', '2/4+1/4', '3/5+1/5', '1/4+2/4', '2/6+3/6', '1/8+3/8', '2/9+4/9', '1/5+3/5', '2/7+3/7', '3/8+4/8', '1/6+4/6'] },
      { title: 'ë¶„ìˆ˜ì˜ ë§ì…ˆ', goal: 'ë¶„ëª¨ê°€ ê°™ì€ ë¶„ìˆ˜ì˜ ë§ì…ˆì„ ê³„ì‚°í•œë‹¤.',
        problems: ['1/4+2/4', '2/5+2/5', '3/7+3/7', '1/6+4/6', '2/8+5/8', '3/9+5/9', '1/3+1/3', '2/6+3/6', '4/9+4/9', '3/8+4/8', '2/7+4/7', '1/5+3/5'] },
      { title: 'ë¶„ìˆ˜ì˜ ëº„ì…ˆ', goal: 'ë¶„ëª¨ê°€ ê°™ì€ ë¶„ìˆ˜ì˜ ëº„ì…ˆì„ ê³„ì‚°í•œë‹¤.',
        problems: ['3/4-1/4', '4/5-2/5', '5/6-2/6', '6/7-3/7', '7/8-4/8', '8/9-3/9', '3/5-1/5', '5/7-2/7', '6/8-1/8', '4/6-1/6', '5/9-2/9', '4/7-1/7'] },
      { title: 'ì†Œìˆ˜ì˜ ê¸°ì´ˆ', goal: 'ì†Œìˆ˜ì˜ ì˜ë¯¸ë¥¼ ì´í•´í•˜ê³  ì†Œìˆ˜ë¥¼ ì½ê³  ì“¸ ìˆ˜ ìˆë‹¤.',
        problems: ['0.1+0.2', '0.3+0.4', '0.2+0.5', '0.6+0.1', '0.4+0.3', '0.7+0.2', '0.5+0.4', '0.8+0.1', '0.3+0.6', '0.2+0.7', '0.4+0.5', '0.1+0.8'] },
      { title: 'ì†Œìˆ˜ì˜ ë§ì…ˆ', goal: 'ì†Œìˆ˜ í•œ ìë¦¬ ìˆ˜ë¼ë¦¬ì˜ ë§ì…ˆì„ ê³„ì‚°í•œë‹¤.',
        problems: ['1.2+2.3', '3.4+1.5', '2.1+4.6', '5.3+2.4', '1.7+3.2', '4.5+1.3', '2.8+3.1', '6.2+1.5', '3.7+2.2', '4.3+3.4', '5.6+2.3', '1.9+3.8'] },
      { title: 'ì†Œìˆ˜ì˜ ëº„ì…ˆ', goal: 'ì†Œìˆ˜ í•œ ìë¦¬ ìˆ˜ë¼ë¦¬ì˜ ëº„ì…ˆì„ ê³„ì‚°í•œë‹¤.',
        problems: ['5.7-2.3', '8.4-3.1', '6.9-4.5', '7.3-2.8', '9.1-5.6', '4.8-1.9', '7.6-3.4', '5.2-2.7', '8.5-4.3', '6.1-3.8', '9.4-6.7', '7.8-5.9'] },
      { title: 'ë¶„ìˆ˜ì™€ ì†Œìˆ˜', goal: 'ë¶„ìˆ˜ì™€ ì†Œìˆ˜ì˜ ê´€ê³„ë¥¼ ì´í•´í•˜ê³  ìƒí˜¸ ë³€í™˜í•œë‹¤.',
        problems: ['1/10=0.?', '3/10=0.?', '7/10=0.?', '0.2=?/10', '0.5=?/10', '0.9=?/10', '2/5=0.?', '3/4=0.?', '1/4=0.?', '0.25=?/4', '0.5=?/2', '0.75=?/4'] },
      { title: 'ë¶„ìˆ˜ì˜ ê³±ì…ˆ ê¸°ì´ˆ', goal: 'ë¶„ìˆ˜ì™€ ìì—°ìˆ˜ì˜ ê³±ì…ˆì„ ì´í•´í•˜ê³  ê³„ì‚°í•œë‹¤.',
        problems: ['1/2Ã—4', '1/3Ã—6', '2/3Ã—3', '1/4Ã—8', '3/4Ã—4', '2/5Ã—5', '1/6Ã—6', '3/7Ã—7', '2/9Ã—9', '1/8Ã—8', '4/5Ã—5', '3/6Ã—6'] },
      { title: 'í˜¼í•© ê³„ì‚°', goal: 'ë¶„ìˆ˜ì™€ ì†Œìˆ˜ë¥¼ í¬í•¨í•œ í˜¼í•© ê³„ì‚°ì„ ì—°ìŠµí•œë‹¤.',
        problems: ['1/2+0.5', '0.3+3/10', '3/4-0.25', '0.6+2/5', '1/5+0.4', '0.75-3/4', '2/5+0.2', '0.7-7/10', '3/5+0.4', '0.8-4/5', '1/4+0.5', '0.3-3/10'] },
      { title: 'Cë‹¨ê³„ ì¢…í•© í‰ê°€', goal: 'Cë‹¨ê³„ ë¶„ìˆ˜Â·ì†Œìˆ˜ ì „ì²´ ì‹¤ë ¥ ì¢…í•© ì ê²€',
        problems: ['1/4+3/4', '5/6-2/6', '0.4+0.7', '1.8-0.9', '2/5Ã—5', '0.3+3/10', '3/4-0.5', '1/3Ã—9', '0.6+2/5', '5/8-0.5', '1/2Ã—6', '0.75+1/4'],
        isTest: true },
    ]
  }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ìƒíƒœ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentStage = 'A';
let currentPage = 1;
let zoom = 100;
let layout = 'single';
let lineStyle = false;
let sidebarOpen = true;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CSS ë³€ìˆ˜ ì—…ë°ì´íŠ¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function applyStageColors(stage) {
  const s = STAGES[stage];
  const root = document.documentElement;
  root.style.setProperty('--stage-color', s.color);
  root.style.setProperty('--stage-light', s.light);
  root.style.setProperty('--stage-mid', s.mid);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ë‹¨ê³„ ì „í™˜
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchStage(stage) {
  if (stage === currentStage) return;
  currentStage = stage;
  currentPage = 1;

  // ì˜¤ë²„ë ˆì´
  const overlay = document.getElementById('stage-overlay');
  const overlayText = document.getElementById('stage-overlay-text');
  overlayText.textContent = STAGES[stage].label;
  overlay.style.background = STAGES[stage].color;
  overlay.classList.add('show');
  setTimeout(() => overlay.classList.remove('show'), 700);

  applyStageColors(stage);
  updateStageUI(stage);
  renderAll();
}

function updateStageUI(stage) {
  const s = STAGES[stage];

  // í€µë©”ë‰´ íƒ­
  document.querySelectorAll('.stage-tab').forEach(t => {
    t.classList.toggle('active', t.dataset.stage === stage);
  });

  // ë¡œê³ 
  document.getElementById('logo-icon').textContent = s.label.slice(0,2);

  // íˆ´ë°” ë°°ì§€
  document.getElementById('tb-stage-label').textContent = s.label + ' Â· ' + s.sub;

  // ì‚¬ì´ë“œë°” í—¤ë”
  document.getElementById('sb-header-text').textContent = s.label + ' í˜ì´ì§€';

  // ìƒíƒœë°”
  document.getElementById('st-stage').textContent = s.label;

  // í˜ì´ì§€ ìˆ˜ ì—…ë°ì´íŠ¸
  const total = s.pages.length;
  document.getElementById('tb-pageinfo').textContent = `${currentPage} / ${total} Â· B5 176Ã—250mm`;
  document.getElementById('st-page').textContent = `${currentPage}/${total}`;
  document.getElementById('pj-label').textContent = `${currentPage} / ${total}`;

  buildPageDropdown();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// í˜ì´ì§€ ë Œë”ë§
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildPageHTML(stageKey, pageIdx) {
  const s = STAGES[stageKey];
  const p = s.pages[pageIdx];
  const pageNum = pageIdx + 1;
  const total = s.pages.length;

  if (!p) {
    return `<div class="b5-page" data-page="${pageNum}" style="animation-delay:${pageIdx*0.05}s">
      <div class="page-stage-bar"></div>
      <div class="page-inner">
        <div class="blank-center">
          <div class="blank-icon">ğŸ“„</div>
          <div class="blank-text">ì—¬ë°± í˜ì´ì§€</div>
        </div>
      </div>
    </div>`;
  }

  const problems = p.problems || [];
  let problemsHTML = '';
  problems.forEach((expr, i) => {
    problemsHTML += `
      <div class="problem-item">
        <span class="problem-num">${i+1})</span>
        <span class="problem-expr">${expr} =</span>
        <div class="problem-answer"></div>
      </div>`;
  });

  const testBadge = p.isTest
    ? `<span style="display:inline-block;margin-left:8px;padding:2px 8px;border-radius:4px;background:${s.color};color:white;font-size:8pt;font-weight:700;font-family:'DM Mono',monospace;vertical-align:middle">í‰ê°€</span>`
    : '';

  return `
    <div class="b5-page" data-page="${pageNum}" style="animation-delay:${pageIdx*0.05}s">
      <div class="page-stage-bar"></div>
      <div class="page-inner${lineStyle ? ' lined' : ''}">
        <div class="page-hd">
          <div class="page-hd-left">
            <div class="page-hd-stage">${s.label} â€” ${stageKey}${String(pageNum).padStart(2,'0')}</div>
            <div class="page-hd-title">${p.title}${testBadge}</div>
          </div>
          <div class="page-hd-right">
            <div class="page-hd-num">${pageNum} / ${total}</div>
            <div class="page-hd-date">ì´ë¦„: ___________</div>
          </div>
        </div>
        <div class="page-goal">
          <div class="page-goal-label">ğŸ¯ í•™ìŠµ ëª©í‘œ</div>
          <div class="page-goal-text">${p.goal}</div>
        </div>
        <div class="page-section-title">ë¬¸ì œ</div>
        <div class="problems-grid">${problemsHTML}</div>
        <div class="page-ft">
          <div class="page-ft-score">ì ìˆ˜ <div class="score-box"></div></div>
          <div class="page-ft-num">${s.label} Â· ${pageNum}p</div>
        </div>
      </div>
    </div>`;
}

function renderAll() {
  const s = STAGES[currentStage];
  const col = document.getElementById('viewer-scroll');
  col.innerHTML = '';

  // ì¤Œ ë˜í¼
  const wrap = document.createElement('div');
  wrap.id = 'zoom-wrap';
  wrap.style.transform = `scale(${zoom/100})`;
  wrap.style.transformOrigin = 'top center';
  wrap.style.display = 'flex';
  wrap.style.flexDirection = layout === 'double' ? 'row' : 'column';
  wrap.style.flexWrap = layout === 'double' ? 'wrap' : 'unset';
  wrap.style.justifyContent = 'center';
  wrap.style.alignItems = layout === 'double' ? 'flex-start' : 'center';
  wrap.style.gap = '32px';
  wrap.style.padding = '40px 60px';

  s.pages.forEach((_, i) => {
    wrap.insertAdjacentHTML('beforeend', buildPageHTML(currentStage, i));
  });

  col.appendChild(wrap);

  // ìŠ¤ì¼€ì¼ ë³´ì •
  const scaleH = wrap.scrollHeight * (zoom / 100);
  col.style.minHeight = scaleH + 'px';

  renderThumbs();
  updatePageDropdownActive();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì¸ë„¤ì¼
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderThumbs() {
  const list = document.getElementById('thumb-list');
  list.innerHTML = '';
  const s = STAGES[currentStage];
  s.pages.forEach((p, i) => {
    const div = document.createElement('div');
    div.className = 'thumb-item' + (i+1 === currentPage ? ' active' : '');
    div.dataset.page = i+1;
    div.onclick = () => goToPage(i+1);
    div.innerHTML = `
      <span class="thumb-num">${i+1}</span>
      <div class="thumb-page">
        <div class="thumb-stage-bar"></div>
        <div class="thumb-content-lines">
          <div class="tl h"></div>
          <div class="tl m"></div>
          <div class="tl s"></div>
          <div class="tl m"></div>
          <div class="tl s"></div>
        </div>
      </div>`;
    list.appendChild(div);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// í˜ì´ì§€ ì´ë™
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function goToPage(num) {
  currentPage = num;
  const target = document.querySelector(`.b5-page[data-page="${num}"]`);
  if (target) {
    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }
  updateCurrentPage(num);
}

function updateCurrentPage(num) {
  currentPage = num;
  const total = STAGES[currentStage].pages.length;
  document.getElementById('tb-pageinfo').textContent = `${num} / ${total} Â· B5 176Ã—250mm`;
  document.getElementById('st-page').textContent = `${num}/${total}`;
  document.getElementById('pj-label').textContent = `${num} / ${total}`;

  document.querySelectorAll('.thumb-item').forEach(t => {
    t.classList.toggle('active', parseInt(t.dataset.page) === num);
  });
  updatePageDropdownActive();
}

// ìŠ¤í¬ë¡¤ ê°ì§€
window.addEventListener('scroll', () => {
  const pages = document.querySelectorAll('.b5-page');
  let current = 1;
  pages.forEach(p => {
    const rect = p.getBoundingClientRect();
    if (rect.top <= 130) current = parseInt(p.dataset.page);
  });
  updateCurrentPage(current);
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// í˜ì´ì§€ ë“œë¡­ë‹¤ìš´
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildPageDropdown() {
  const dd = document.getElementById('page-dropdown');
  dd.innerHTML = '';
  const total = STAGES[currentStage].pages.length;
  for (let i = 1; i <= total; i++) {
    const d = document.createElement('div');
    d.className = 'pd-item' + (i === currentPage ? ' current' : '');
    d.textContent = i;
    d.onclick = () => { goToPage(i); closePageDropdown(); };
    dd.appendChild(d);
  }
}

function updatePageDropdownActive() {
  document.querySelectorAll('.pd-item').forEach(d => {
    d.classList.toggle('current', parseInt(d.textContent) === currentPage);
  });
}

function togglePageDropdown() {
  const dd = document.getElementById('page-dropdown');
  dd.classList.toggle('open');
}

function closePageDropdown() {
  document.getElementById('page-dropdown').classList.remove('open');
}

document.addEventListener('click', e => {
  if (!e.target.closest('.page-jump-wrap')) closePageDropdown();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì¤Œ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function changeZoom(delta) {
  zoom = Math.max(50, Math.min(200, zoom + delta));
  applyZoom();
}
function resetZoom() { zoom = 100; applyZoom(); }
function applyZoom() {
  const wrap = document.getElementById('zoom-wrap');
  if (wrap) {
    wrap.style.transform = `scale(${zoom/100})`;
    const scaleH = wrap.scrollHeight * (zoom / 100);
    wrap.parentElement.style.minHeight = scaleH + 40 + 'px';
  }
  document.getElementById('zoom-val').textContent = zoom + '%';
  document.getElementById('st-zoom').textContent = zoom + '%';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ë ˆì´ì•„ì›ƒ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setLayout(val) {
  layout = val;
  document.getElementById('btn-single').classList.toggle('active', val === 'single');
  document.getElementById('btn-double').classList.toggle('active', val === 'double');
  document.getElementById('st-layout').textContent = val === 'single' ? 'ë‹¨ë©´' : 'ì–‘ë©´';
  renderAll();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì¤„ ìŠ¤íƒ€ì¼
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleLineStyle() {
  lineStyle = !lineStyle;
  document.getElementById('line-btn-text').textContent = lineStyle ? 'ì¤„ ìˆ¨ê¸°ê¸°' : 'ì¤„ í‘œì‹œ';
  renderAll();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì‚¬ì´ë“œë°”
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleSidebar() {
  sidebarOpen = !sidebarOpen;
  const sb = document.getElementById('sidebar');
  const vm = document.getElementById('viewer-main');
  sb.classList.toggle('hidden', !sidebarOpen);
  vm.classList.toggle('full', !sidebarOpen);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì´ˆê¸°í™”
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
applyStageColors('A');
updateStageUI('A');
buildPageDropdown();
renderAll();
</script>
</body>
</html>
